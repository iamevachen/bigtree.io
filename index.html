<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ˜Ÿç«è®¡åˆ’ | SPARK PRO 3.0 æ•°æ®é©±åŠ¨ç®¡ç†ç³»ç»Ÿ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        tiffany: '#81D8D0', cloud: '#E9EDF0', beanRed: '#d8575d',
                        mistBlue: '#a3bbce', camel: '#d6cfbb', slateDeep: '#2A313D'
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { background-color: #E9EDF0; font-family: 'Inter', 'PingFang SC', sans-serif; overflow: hidden; }
        
        /* ä¾§è¾¹æ å¯¹é½ä¼˜åŒ– */
        .nav-item { display: grid; grid-template-columns: 3.5rem 1fr; align-items: center; cursor: pointer; transition: all 0.3s; @apply py-4 rounded-2xl text-slateDeep/50; }
        .nav-item i { justify-self: center; }
        .nav-active { @apply bg-white shadow-xl shadow-gray-200/50 text-tiffany font-black; }

        /* ä¿®å¤å¼¹çª—ï¼šå…è®¸å†…éƒ¨æ»šåŠ¨ï¼Œä¸é˜»å¡æ“ä½œ */
        .modal-scroll-area { max-height: calc(90vh - 120px); overflow-y: auto; scrollbar-width: thin; scrollbar-color: #81D8D0 transparent; }
        .modal-scroll-area::-webkit-scrollbar { width: 5px; }
        .modal-scroll-area::-webkit-scrollbar-thumb { background: #81D8D0; border-radius: 10px; }

        .tech-card { @apply bg-white rounded-[2rem] shadow-sm border border-white p-6 transition-all hover:shadow-md; }
        .viral-badge { @apply bg-beanRed text-white text-[10px] px-3 py-1 rounded-full italic font-black animate-pulse; }
    </style>
</head>
<body class="flex h-screen w-screen">

    <div id="loginGate" class="fixed inset-0 z-[200] bg-slateDeep/95 backdrop-blur-xl flex items-center justify-center p-6">
        <div class="bg-white w-full max-w-md rounded-[3rem] p-10 text-center shadow-2xl">
            <div class="w-20 h-20 bg-tiffany rounded-3xl mx-auto mb-6 flex items-center justify-center text-white shadow-2xl shadow-tiffany/40">
                <i data-lucide="shield-check" class="w-10 h-10"></i>
            </div>
            <h2 class="text-3xl font-black text-slateDeep italic tracking-tighter">SPARK <span class="text-tiffany">LOGIN</span></h2>
            <p class="text-gray-400 text-sm mt-2 mb-8 uppercase tracking-widest font-bold">è¯·è¾“å…¥èº«ä»½ä¿¡æ¯è¿›å…¥ç³»ç»Ÿ</p>
            <div class="space-y-4">
                <input type="text" id="u_nick" placeholder="å¾®ä¿¡æ˜µç§° / Nickname" class="w-full px-6 py-4 bg-cloud rounded-2xl border-none outline-none focus:ring-2 ring-tiffany/50 font-bold">
                <input type="email" id="u_email" placeholder="æ³¨å†Œé‚®ç®± / Email" class="w-full px-6 py-4 bg-cloud rounded-2xl border-none outline-none focus:ring-2 ring-tiffany/50 font-bold">
                <button onclick="app.doLogin()" class="w-full py-5 bg-tiffany text-white rounded-2xl font-black shadow-xl shadow-tiffany/30 active:scale-95 transition-all">è¿›å…¥ä½œæˆ˜å®¤</button>
            </div>
        </div>
    </div>

    <aside class="w-72 bg-white/80 backdrop-blur-md border-r border-gray-100 flex flex-col py-10 shrink-0">
        <div class="px-10 mb-16">
            <div class="text-2xl font-black italic tracking-tighter text-slateDeep">SPARK <span class="text-tiffany text-sm">PRO</span></div>
            <div class="w-10 h-1.5 bg-tiffany mt-2 rounded-full"></div>
        </div>
        
        <nav class="flex-1 px-4 space-y-3">
            <div onclick="app.navigate('dashboard')" id="nav-dashboard" class="nav-item nav-active"><i data-lucide="bar-chart-big"></i><span class="text-sm tracking-widest uppercase">çœ‹æ¿</span></div>
            <div onclick="app.navigate('data')" id="nav-data" class="nav-item"><i data-lucide="layers"></i><span class="text-sm tracking-widest uppercase">æ•°æ®</span></div>
            <div onclick="app.navigate('wall')" id="nav-wall" class="nav-item"><i data-lucide="flame"></i><span class="text-sm tracking-widest uppercase">çˆ†æ–‡å¢™</span></div>
            <div onclick="app.navigate('mine')" id="nav-mine" class="nav-item"><i data-lucide="user-square"></i><span class="text-sm tracking-widest uppercase">æˆ‘çš„</span></div>
        </nav>

        <div class="px-8 mt-auto pt-8 border-t border-gray-50">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-cloud rounded-xl flex items-center justify-center text-tiffany font-black" id="userInitial">?</div>
                <div>
                    <p class="text-xs font-black text-slateDeep" id="userNameDisplay">æœªç™»å½•</p>
                    <p class="text-[9px] text-gray-400 uppercase font-bold">Spark Member</p>
                </div>
            </div>
        </div>
    </aside>

    <main class="flex-1 flex flex-col min-w-0">
        <header class="h-24 px-12 flex items-center justify-between border-b border-gray-100 bg-white/30">
            <h2 id="viewTitle" class="text-sm font-black text-slateDeep uppercase tracking-[0.3em] italic">Dashboard</h2>
            <div id="statsQuickView" class="flex gap-8">
                </div>
        </header>

        <section id="mainView" class="flex-1 overflow-y-auto p-12 custom-scroll">
            </section>
    </main>

    <div id="modal" class="fixed inset-0 z-[150] hidden bg-slateDeep/60 backdrop-blur-md flex items-center justify-center p-6">
        <div class="bg-white w-full max-w-3xl rounded-[3rem] shadow-2xl overflow-hidden animate-in zoom-in duration-300">
            <div class="px-10 py-8 bg-slateDeep text-white flex justify-between items-center">
                <div>
                    <h3 class="text-xl font-black italic tracking-tighter text-tiffany">NEW DATA ENTRY</h3>
                    <p class="text-[10px] opacity-40 font-bold uppercase mt-1">è¯·å¡«å†™ 24H ç¬”è®°çœŸå®è¡¨ç°æ•°æ®</p>
                </div>
                <button onclick="app.closeModal()" class="w-12 h-12 rounded-full hover:bg-white/10 transition-colors flex items-center justify-center"><i data-lucide="x"></i></button>
            </div>

            <form id="recordForm" class="modal-scroll-area p-10 space-y-8">
                <div class="grid grid-cols-2 gap-8">
                    <div class="space-y-2">
                        <label class="text-[10px] font-black text-gray-400 uppercase">ç¬”è®°æ ‡é¢˜ (Title)</label>
                        <input type="text" id="f_title" required class="w-full px-6 py-4 bg-cloud rounded-2xl border-none outline-none focus:ring-2 ring-tiffany/50 font-bold">
                    </div>
                    <div class="space-y-2">
                        <label class="text-[10px] font-black text-gray-400 uppercase">å†…å®¹åˆ†ç±» (Category)</label>
                        <select id="f_type" class="w-full px-6 py-4 bg-cloud rounded-2xl border-none outline-none font-bold">
                            <option>Flowithæ ‡ç­¾</option>
                            <option>å¬è¯¾ç¬”è®°</option>
                            <option>å…¶ä»–ç±»å‹</option>
                        </select>
                    </div>
                </div>

                <div class="space-y-2">
                    <label class="text-[10px] font-black text-gray-400 uppercase">å°çº¢ä¹¦é“¾æ¥ (Link)</label>
                    <input type="url" id="f_link" placeholder="https://www.xiaohongshu.com/..." class="w-full px-6 py-4 bg-cloud rounded-2xl border-none outline-none text-sm">
                </div>

                <div class="grid grid-cols-4 gap-4">
                    <div class="bg-cloud p-4 rounded-2xl text-center">
                        <p class="text-[9px] font-black text-gray-400 mb-1 uppercase">é˜…è¯»é‡</p>
                        <input type="number" id="v_read" value="0" class="w-full bg-transparent text-center font-black text-xl text-tiffany outline-none">
                    </div>
                    <div class="bg-cloud p-4 rounded-2xl text-center">
                        <p class="text-[9px] font-black text-gray-400 mb-1 uppercase">ç‚¹èµ</p>
                        <input type="number" id="v_like" value="0" class="w-full bg-transparent text-center font-black text-xl text-slateDeep outline-none">
                    </div>
                    <div class="bg-cloud p-4 rounded-2xl text-center">
                        <p class="text-[9px] font-black text-gray-400 mb-1 uppercase">æ”¶è—</p>
                        <input type="number" id="v_star" value="0" class="w-full bg-transparent text-center font-black text-xl text-slateDeep outline-none">
                    </div>
                    <div class="bg-cloud p-4 rounded-2xl text-center">
                        <p class="text-[9px] font-black text-gray-400 mb-1 uppercase">è¯„è®º</p>
                        <input type="number" id="v_comm" value="0" class="w-full bg-transparent text-center font-black text-xl text-slateDeep outline-none">
                    </div>
                </div>

                <div class="space-y-2">
                    <label class="text-[10px] font-black text-gray-400 uppercase">å…³é”®å‡­è¯ (ä¸Šä¼ æ•°æ®æˆªå›¾/å°é¢)</label>
                    <div onclick="document.getElementById('f_file').click()" class="border-2 border-dashed border-tiffany/20 rounded-[2rem] p-8 text-center cursor-pointer hover:bg-tiffany/5 transition-all group relative overflow-hidden">
                        <i data-lucide="image-plus" class="w-10 h-10 mx-auto text-tiffany mb-2"></i>
                        <p class="text-xs font-black text-slateDeep uppercase">Click to upload screenshot</p>
                        <input type="file" id="f_file" class="hidden" accept="image/*" onchange="app.handleImage(this)">
                        <img id="imgPreview" class="absolute inset-0 w-full h-full object-cover hidden">
                    </div>
                </div>

                <div class="space-y-2">
                    <label class="text-[10px] font-black text-gray-400 uppercase italic">ä¸€å¥è¯å¤ç›˜æ€»ç»“</label>
                    <textarea id="f_review" placeholder="æ€»ç»“æ­¤æ¬¡æˆåŠŸçš„å…³é”®å› å­..." class="w-full px-6 py-4 bg-cloud rounded-2xl border-none outline-none h-24 text-sm"></textarea>
                </div>

                <button type="submit" class="w-full py-6 bg-tiffany text-white font-black rounded-[2rem] shadow-2xl shadow-tiffany/30 hover:bg-slateDeep transition-all uppercase tracking-widest italic">
                    Push to Database / ç«‹å³ä¿å­˜å¹¶åŒæ­¥
                </button>
            </form>
        </div>
    </div>

    <button onclick="app.openModal()" class="fixed bottom-12 right-12 w-20 h-20 bg-tiffany text-white rounded-full shadow-2xl flex items-center justify-center hover:scale-110 hover:rotate-90 transition-all z-[100] active:scale-95">
        <i data-lucide="plus" class="w-10 h-10"></i>
    </button>

    <script>
        const app = {
            state: {
                user: JSON.parse(localStorage.getItem('spark_user')) || null,
                view: 'dashboard',
                threshold: 1000,
                db: JSON.parse(localStorage.getItem('spark_db_v3')) || [],
                tempImg: null
            },

            init() {
                lucide.createIcons();
                if (this.state.user) {
                    document.getElementById('loginGate').classList.add('hidden');
                    this.updateUserInfo();
                }
                this.navigate('dashboard');
            },

            doLogin() {
                const nick = document.getElementById('u_nick').value;
                if (!nick) return alert('è¯·è¾“å…¥æ˜µç§°');
                this.state.user = { nick, email: document.getElementById('u_email').value };
                localStorage.setItem('spark_user', JSON.stringify(this.state.user));
                document.getElementById('loginGate').classList.add('hidden');
                this.updateUserInfo();
                this.navigate('dashboard');
            },

            updateUserInfo() {
                document.getElementById('userNameDisplay').innerText = this.state.user.nick;
                document.getElementById('userInitial').innerText = this.state.user.nick[0].toUpperCase();
            },

            navigate(v) {
                this.state.view = v;
                document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('nav-active'));
                document.getElementById(`nav-${v}`).classList.add('nav-active');
                document.getElementById('viewTitle').innerText = v;
                this.render();
            },

            // æ ¸å¿ƒåŠŸèƒ½ï¼šæ•°æ®æ¸²æŸ“é€»è¾‘ (ç¡®ä¿æ¯æ¬¡æ“ä½œåéƒ½è°ƒç”¨ï¼Œå®ç°å³æ—¶åˆ·æ–°)
            render() {
                const container = document.getElementById('mainView');
                container.innerHTML = '';
                
                if (this.state.view === 'dashboard') this.renderDashboard(container);
                if (this.state.view === 'data') this.renderDataTable(container);
                if (this.state.view === 'wall') this.renderWall(container);
                if (this.state.view === 'mine') this.renderMine(container);
                
                lucide.createIcons();
            },

            renderDashboard(el) {
                const totalReads = this.state.db.reduce((s, i) => s + parseInt(i.read), 0);
                const viralCount = this.state.db.filter(i => i.viral).length;

                el.innerHTML = `
                    <div class="grid grid-cols-4 gap-8 mb-12">
                        <div class="tech-card border-b-8 border-tiffany">
                            <p class="text-[10px] font-black text-gray-400 uppercase">å…¨è¥æ€»æµé‡</p>
                            <h4 class="text-4xl font-black mt-2 text-slateDeep">${totalReads.toLocaleString()}</h4>
                        </div>
                        <div class="tech-card border-b-8 border-beanRed">
                            <p class="text-[10px] font-black text-gray-400 uppercase">æœ¬å‘¨çˆ†æ–‡æ•°</p>
                            <h4 class="text-4xl font-black mt-2 text-slateDeep">${viralCount}</h4>
                        </div>
                        <div class="tech-card border-b-8 border-mistBlue">
                            <p class="text-[10px] font-black text-gray-400 uppercase">æ€»å‘å¸ƒç¯‡æ•°</p>
                            <h4 class="text-4xl font-black mt-2 text-slateDeep">${this.state.db.length}</h4>
                        </div>
                        <div class="tech-card border-b-8 border-camel">
                            <p class="text-[10px] font-black text-gray-400 uppercase">çˆ†æ–‡ç‡ (Avg)</p>
                            <h4 class="text-4xl font-black mt-2 text-slateDeep">${this.state.db.length ? ((viralCount/this.state.db.length)*100).toFixed(1) : 0}%</h4>
                        </div>
                    </div>
                    <div class="grid grid-cols-3 gap-8">
                        <div class="col-span-2 tech-card h-[450px]">
                            <p class="font-black text-xs uppercase mb-6 tracking-widest italic">Growth Trend / å¢é•¿æ›²çº¿</p>
                            <canvas id="mainChart"></canvas>
                        </div>
                        <div class="tech-card">
                            <p class="font-black text-xs uppercase mb-6 tracking-widest italic">Top Ranking / æˆ˜åŠ›æ¦œ</p>
                            <div class="space-y-6">
                                ${this.state.db.sort((a,b)=>b.read-a.read).slice(0,5).map((item, idx) => `
                                    <div class="flex items-center gap-4">
                                        <div class="w-8 h-8 rounded-lg bg-cloud flex items-center justify-center font-black text-xs">${idx+1}</div>
                                        <div class="flex-1 min-w-0">
                                            <p class="text-xs font-black truncate">${item.title}</p>
                                            <p class="text-[9px] text-gray-400 uppercase font-bold">${item.user}</p>
                                        </div>
                                        <div class="text-tiffany font-black italic">${item.read}</div>
                                    </div>
                                `).join('') || '<p class="text-center py-20 text-gray-300 italic">ç­‰å¾…é¦–ç¯‡çˆ†æ–‡äº§ç”Ÿ...</p>'}
                            </div>
                        </div>
                    </div>
                `;
                this.renderChart();
            },

            renderDataTable(el) {
                el.innerHTML = `
                    <div class="tech-card p-0 overflow-hidden">
                        <table class="w-full text-left">
                            <thead class="bg-slateDeep text-white text-[10px] font-black uppercase tracking-[0.3em]">
                                <tr>
                                    <th class="px-10 py-6">å‘å¸ƒè¯¦æƒ…</th>
                                    <th class="px-10 py-6">å®æ—¶æ•°æ®</th>
                                    <th class="px-10 py-6">çŠ¶æ€æ ‡è®°</th>
                                    <th class="px-10 py-6 text-right">ç®¡ç†</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-50">
                                ${this.state.db.map(item => `
                                    <tr class="hover:bg-cloud/30 transition-colors">
                                        <td class="px-10 py-6">
                                            <p class="text-sm font-black text-slateDeep">${item.title}</p>
                                            <p class="text-[9px] text-gray-400 font-bold uppercase mt-1">${item.user} Â· ${item.type} Â· ${item.time}</p>
                                        </td>
                                        <td class="px-10 py-6">
                                            <div class="flex gap-4 font-mono text-xs font-black">
                                                <span class="text-tiffany italic">ğŸ‘ï¸ ${item.read}</span>
                                                <span class="text-slateDeep/50">â¤ï¸ ${item.like}</span>
                                            </div>
                                        </td>
                                        <td class="px-10 py-6">
                                            ${item.viral ? '<span class="viral-badge">SPARK VIRAL</span>' : '<span class="text-[9px] font-bold text-gray-300 uppercase italic">Steady</span>'}
                                        </td>
                                        <td class="px-10 py-6 text-right">
                                            <button class="text-gray-300 hover:text-slateDeep transition-colors"><i data-lucide="more-horizontal"></i></button>
                                        </td>
                                    </tr>
                                `).join('') || '<tr><td colspan="4" class="py-32 text-center text-gray-300 italic font-bold">æš‚æ— æ•°æ®è®°å½•ï¼Œè¯·å½•å…¥ç¬¬ä¸€ç¯‡ç¬”è®°</td></tr>'}
                            </tbody>
                        </table>
                    </div>
                `;
            },

            renderWall(el) {
                const virals = this.state.db.filter(i => i.viral);
                el.innerHTML = `
                    <div class="columns-1 sm:columns-2 md:columns-4 gap-8 space-y-8">
                        ${virals.map(item => `
                            <div class="tech-card p-0 overflow-hidden group">
                                <div class="relative">
                                    <img src="${item.img || 'https://images.unsplash.com/photo-1611162617213-7d7a39e9b1d7?w=400'}" class="w-full object-cover grayscale-[0.5] group-hover:grayscale-0 transition-all duration-500">
                                    <div class="absolute bottom-4 left-4 bg-black/60 backdrop-blur-md px-4 py-1.5 rounded-full text-white font-black text-[10px] italic">ğŸ‘ï¸ ${item.read}</div>
                                </div>
                                <div class="p-6">
                                    <h4 class="font-black text-sm text-slateDeep mb-2 line-clamp-2">${item.title}</h4>
                                    <p class="text-[10px] text-gray-400 font-bold uppercase italic">${item.user}</p>
                                </div>
                            </div>
                        `).join('') || '<div class="col-span-full py-40 text-center font-black text-gray-300 italic tracking-widest">ç›®å‰æš‚æ— æ»¡è¶³é˜ˆå€¼çš„çˆ†æ–‡...</div>'}
                    </div>
                `;
            },

            renderMine(el) {
                const mine = this.state.db.filter(i => i.user === this.state.user.nick);
                el.innerHTML = `
                    <div class="grid grid-cols-3 gap-12">
                        <div class="tech-card bg-slateDeep text-white py-12 text-center h-fit">
                            <div class="w-24 h-24 bg-tiffany rounded-[2.5rem] mx-auto mb-6 flex items-center justify-center text-3xl font-black">${this.state.user.nick[0]}</div>
                            <h3 class="text-2xl font-black">${this.state.user.nick}</h3>
                            <p class="text-tiffany text-[10px] font-black uppercase mt-1 tracking-widest italic">Spark Elite Member</p>
                            <div class="grid grid-cols-2 gap-4 mt-10 px-6">
                                <div class="bg-white/5 p-4 rounded-2xl border border-white/10">
                                    <p class="text-[9px] opacity-40 font-bold uppercase">æˆ‘çš„çˆ†æ–‡æ•°</p>
                                    <p class="text-2xl font-black mt-1">${mine.filter(i=>i.viral).length}</p>
                                </div>
                                <div class="bg-white/5 p-4 rounded-2xl border border-white/10">
                                    <p class="text-[9px] opacity-40 font-bold uppercase">æ€»é˜…è¯»é‡</p>
                                    <p class="text-2xl font-black mt-1">${mine.reduce((s,i)=>s+parseInt(i.read), 0)}</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-span-2 space-y-6">
                            <h3 class="text-sm font-black text-slateDeep italic uppercase tracking-widest">My Records / å‘å¸ƒè®°å½•</h3>
                            ${mine.map(item => `
                                <div class="tech-card flex items-center justify-between">
                                    <div class="flex gap-6 items-center">
                                        <div class="w-16 h-16 bg-cloud rounded-2xl overflow-hidden shrink-0"><img src="${item.img}" class="w-full h-full object-cover"></div>
                                        <div>
                                            <p class="font-black text-slateDeep">${item.title}</p>
                                            <p class="text-[9px] text-gray-400 font-bold uppercase mt-1">${item.time} / ${item.type}</p>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <p class="text-xl font-black text-tiffany italic">${item.read}</p>
                                        <p class="text-[9px] text-gray-400 font-bold uppercase italic tracking-widest">Views</p>
                                    </div>
                                </div>
                            `).join('') || '<p class="text-center py-20 text-gray-300 font-bold italic">ä½ è¿˜æ²¡æœ‰å‘å¸ƒä»»ä½•è®°å½•...</p>'}
                        </div>
                    </div>
                `;
            },

            renderChart() {
                const ctx = document.getElementById('mainChart')?.getContext('2d');
                if (!ctx) return;
                new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['M', 'T', 'W', 'T', 'F', 'S', 'S'],
                        datasets: [{ 
                            label: 'Views', 
                            data: [1200, 3400, 2100, 5600, 8900, 15000, 22000], 
                            borderColor: '#81D8D0', 
                            borderWidth: 6,
                            tension: 0.4,
                            fill: true,
                            backgroundColor: 'rgba(129, 216, 208, 0.1)'
                        }]
                    },
                    options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { y: { display: false }, x: { grid: { display: false } } } }
                });
            },

            openModal() { document.getElementById('modal').classList.remove('hidden'); },
            closeModal() { document.getElementById('modal').classList.add('hidden'); },

            handleImage(input) {
                if (input.files && input.files[0]) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        this.state.tempImg = e.target.result;
                        const prev = document.getElementById('imgPreview');
                        prev.src = e.target.result;
                        prev.classList.remove('hidden');
                    };
                    reader.readAsDataURL(input.files[0]);
                }
            }
        };

        // 5. æ ¸å¿ƒï¼šæäº¤é€»è¾‘ä¿®å¤
        document.getElementById('recordForm').onsubmit = (e) => {
            e.preventDefault();
            const readCount = parseInt(document.getElementById('v_read').value);
            
            const record = {
                user: app.state.user.nick,
                title: document.getElementById('f_title').value,
                type: document.getElementById('f_type').value,
                link: document.getElementById('f_link').value,
                read: readCount,
                like: document.getElementById('v_like').value,
                star: document.getElementById('v_star').value,
                comm: document.getElementById('v_comm').value,
                img: app.state.tempImg,
                review: document.getElementById('f_review').value,
                time: new Date().toLocaleDateString(),
                viral: readCount >= app.state.threshold
            };

            // å­˜å…¥æ•°ç»„å¹¶å†™å…¥ç¼“å­˜
            app.state.db.unshift(record);
            localStorage.setItem('spark_db_v3', JSON.stringify(app.state.db));

            // å½»åº•æ¸…ç©ºè¡¨å•
            e.target.reset();
            app.state.tempImg = null;
            document.getElementById('imgPreview').classList.add('hidden');
            
            // å…³é—­å¹¶åˆ·æ–°
            app.closeModal();
            app.render(); // æ ¸å¿ƒï¼šæ“ä½œåç«‹å³å…¨é‡é‡æ–°æ¸²æŸ“ï¼Œæ•°æ®ç§’æ›´æ–°
            alert('ğŸš€ æ•°æ®å·²åŒæ­¥è‡³äº‘ç«¯çœ‹æ¿ï¼');
        };

        window.onload = () => app.init();
    </script>
</body>
</html>
