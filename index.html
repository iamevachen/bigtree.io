<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>星火计划 | 数据统计</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        tiffany: '#81D8D0',   // 蒂芙尼蓝
                        cloud: '#E9EDF0',     // 浅云
                        slateDeep: '#2A313D', // 青灰
                        acidPurple: '#5B34C1',// 酸性紫
                        mintBlue: '#04789E',  // 薄荷浅青
                    }
                }
            }
        }
    </script>
    <style>
        body { background-color: #E9EDF0; color: #2A313D; font-family: 'Inter', system-ui, sans-serif; }
        
        /* 导航对齐与框选 */
        .nav-link { @apply flex items-center gap-4 px-6 py-4 rounded-2xl border border-transparent transition-all; }
        .nav-active { @apply border-tiffany bg-slateDeep text-tiffany shadow-lg; }
        .nav-link:hover:not(.nav-active) { @apply bg-white border-gray-200; }

        /* 上传区域 */
        .upload-zone { @apply border-2 border-dashed border-acidPurple/30 rounded-2xl p-6 text-center cursor-pointer hover:bg-acidPurple/5 transition-all; }
        
        /* 科技感卡片 */
        .tech-card { @apply bg-white rounded-[2rem] border border-white shadow-sm overflow-hidden; }
        
        /* 图片预览小眼睛 */
        .preview-eye { @apply absolute inset-0 bg-acidPurple/60 opacity-0 group-hover:opacity-100 flex items-center justify-center transition-all cursor-pointer rounded-xl; }
    </style>
</head>
<body class="flex h-screen overflow-hidden">

    <aside class="w-72 bg-white/80 backdrop-blur-xl border-r border-gray-200 flex flex-col p-8 shrink-0">
        <div class="flex items-center gap-4 mb-12 px-2">
            <div class="w-10 h-10 bg-acidPurple rounded-xl flex items-center justify-center">
                <i data-lucide="shield-check" class="text-white w-6 h-6"></i>
            </div>
            <h1 class="font-black text-2xl tracking-tighter text-slateDeep italic">SPARK <span class="text-tiffany italic">PRO</span></h1>
        </div>

        <nav class="space-y-4 flex-1">
            <button onclick="app.navigate('dashboard')" id="nav-dashboard" class="nav-link w-full nav-active">
                <div class="w-6 flex justify-center"><i data-lucide="monitor"></i></div>
                <span class="font-bold tracking-wide">看板</span>
            </button>
            <button onclick="app.navigate('data')" id="nav-data" class="nav-link w-full text-gray-400">
                <div class="w-6 flex justify-center"><i data-lucide="database"></i></div>
                <span class="font-bold tracking-wide">数据</span>
            </button>
            <button onclick="app.navigate('wall')" id="nav-wall" class="nav-link w-full text-gray-400">
                <div class="w-6 flex justify-center"><i data-lucide="flame"></i></div>
                <span class="font-bold tracking-wide">爆文墙</span>
            </button>
            <button onclick="app.navigate('mine')" id="nav-mine" class="nav-link w-full text-gray-400">
                <div class="w-6 flex justify-center"><i data-lucide="user-cog"></i></div>
                <span class="font-bold tracking-wide">我的</span>
            </button>
        </nav>
    </aside>

    <main class="flex-1 flex flex-col overflow-hidden">
        <header class="h-24 px-12 flex items-center justify-between border-b border-gray-200 bg-white/50">
            <h2 id="page-title" class="text-xl font-black text-slateDeep uppercase tracking-widest">System Control / 录入系统</h2>
            <button onclick="app.openModal()" class="bg-acidPurple px-8 py-4 rounded-2xl text-white font-black text-sm shadow-xl shadow-acidPurple/30 active:scale-95 transition-all">
                + 新增笔记记录
            </button>
        </header>

        <section id="main-content" class="flex-1 overflow-y-auto p-12">
            </section>
    </main>

    <div id="modal" class="fixed inset-0 z-50 hidden bg-slateDeep/80 backdrop-blur-md flex items-center justify-center p-6">
        <div class="bg-white w-full max-w-2xl rounded-[3rem] shadow-2xl overflow-hidden flex flex-col max-h-[90vh]">
            <div class="p-10 bg-slateDeep text-white flex justify-between items-center">
                <div>
                    <h3 class="font-black text-2xl text-tiffany tracking-tighter">NEW RECORD</h3>
                    <p class="text-[10px] opacity-40 uppercase tracking-widest font-bold mt-1">关键凭证与数据存档</p>
                </div>
                <button onclick="app.closeModal()" class="w-12 h-12 rounded-full hover:bg-white/10 flex items-center justify-center transition-colors"><i data-lucide="x"></i></button>
            </div>

            <form id="noteForm" class="p-10 space-y-8 overflow-y-auto">
                <div class="grid grid-cols-2 gap-6">
                    <div class="space-y-2">
                        <label class="text-[10px] font-black text-gray-400 uppercase">笔记标题</label>
                        <input type="text" id="m_title" required class="w-full px-6 py-4 bg-cloud rounded-2xl border-none focus:ring-2 ring-tiffany/50 outline-none">
                    </div>
                    <div class="space-y-2">
                        <label class="text-[10px] font-black text-gray-400 uppercase">发布类型</label>
                        <select id="m_type" class="w-full px-6 py-4 bg-cloud rounded-2xl border-none outline-none font-bold">
                            <option>flowith标签</option>
                            <option>听课笔记</option>
                            <option>其他类型（需说明）</option>
                        </select>
                    </div>
                </div>

                <div class="space-y-2">
                    <label class="text-[10px] font-black text-gray-400 uppercase">关键凭证上传 (封面/数据截图)</label>
                    <div class="flex gap-4">
                        <div id="uploadContainer" onclick="document.getElementById('fileInput').click()" class="upload-zone flex-1">
                            <i data-lucide="image-plus" class="w-8 h-8 mx-auto text-acidPurple mb-2"></i>
                            <p class="text-xs font-bold text-slateDeep">点击上传封面或数据截图</p>
                            <input type="file" id="fileInput" class="hidden" accept="image/*" onchange="app.handleUpload(this)">
                        </div>
                        <div id="imagePreview" class="w-32 h-32 hidden relative group">
                            <img id="previewImg" src="" class="w-full h-full object-cover rounded-2xl border-2 border-tiffany shadow-md">
                            <div class="preview-eye" onclick="app.viewLargeImage()">
                                <i data-lucide="eye" class="text-white w-6 h-6"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-4 gap-4">
                    <div class="bg-cloud p-4 rounded-2xl text-center">
                        <p class="text-[9px] font-bold text-gray-400 mb-1">阅读</p>
                        <input id="v_read" type="number" value="0" class="w-full bg-transparent text-center font-black text-xl text-acidPurple border-none outline-none">
                    </div>
                    <div class="bg-cloud p-4 rounded-2xl text-center">
                        <p class="text-[9px] font-bold text-gray-400 mb-1">点赞</p>
                        <input id="v_like" type="number" value="0" class="w-full bg-transparent text-center font-black text-xl text-slateDeep border-none outline-none">
                    </div>
                    </div>

                <div class="space-y-2">
                    <label class="text-[10px] font-black text-gray-400 uppercase italic">一句话复盘</label>
                    <textarea id="m_review" placeholder="这篇笔记做对了什么？哪里可以优化？" class="w-full px-6 py-4 bg-cloud rounded-2xl border-none outline-none h-24 text-sm"></textarea>
                </div>

                <button type="submit" class="w-full py-6 bg-acidPurple text-white font-black rounded-3xl shadow-2xl shadow-acidPurple/30 hover:bg-tiffany hover:text-slateDeep transition-all uppercase tracking-widest">
                    Save Record / 保存记录
                </button>
            </form>
        </div>
    </div>

    <div id="largePreview" class="fixed inset-0 z-[100] hidden bg-slateDeep/95 flex items-center justify-center p-10" onclick="this.classList.add('hidden')">
        <img id="largeImg" src="" class="max-w-full max-h-full rounded-xl shadow-2xl border-4 border-white/10">
        <p class="absolute bottom-10 text-white font-black uppercase tracking-widest">点击任意处关闭预览</p>
    </div>

    <script>
        const app = {
            state: {
                view: 'data',
                currentImg: null,
                db: JSON.parse(localStorage.getItem('spark_pro_db')) || []
            },

            init() {
                lucide.createIcons();
                this.navigate('data');
            },

            navigate(v) {
                this.state.view = v;
                document.querySelectorAll('.nav-link').forEach(el => el.classList.remove('nav-active'));
                document.getElementById(`nav-${v}`).classList.add('nav-active');
                
                const content = document.getElementById('main-content');
                if(v === 'data') this.renderTable(content);
                lucide.createIcons();
            },

            handleUpload(input) {
                if (input.files && input.files[0]) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        this.state.currentImg = e.target.result;
                        document.getElementById('previewImg').src = e.target.result;
                        document.getElementById('imagePreview').classList.remove('hidden');
                        document.getElementById('uploadContainer').classList.add('opacity-40');
                        lucide.createIcons();
                    };
                    reader.readAsDataURL(input.files[0]);
                }
            },

            viewLargeImage() {
                document.getElementById('largeImg').src = this.state.currentImg;
                document.getElementById('largePreview').classList.remove('hidden');
            },

            renderTable(el) {
                el.innerHTML = `
                    <div class="tech-card">
                        <table class="w-full text-left">
                            <thead class="bg-slateDeep text-white text-[10px] font-black uppercase tracking-[0.2em]">
                                <tr>
                                    <th class="px-10 py-6">笔记详情</th>
                                    <th class="px-10 py-6">凭证</th>
                                    <th class="px-10 py-6">阅读量</th>
                                    <th class="px-10 py-6">复盘总结</th>
                                    <th class="px-10 py-6">操作</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-100">
                                ${this.state.db.map(item => `
                                    <tr class="hover:bg-cloud/30">
                                        <td class="px-10 py-6">
                                            <p class="font-black text-slateDeep">${item.title}</p>
                                            <p class="text-[10px] text-gray-400 mt-1 uppercase">${item.type}</p>
                                        </td>
                                        <td class="px-10 py-6">
                                            ${item.img ? `<img src="${item.img}" class="w-10 h-10 rounded-lg border border-gray-200 object-cover">` : '<span class="text-gray-300">-</span>'}
                                        </td>
                                        <td class="px-10 py-6 font-black text-acidPurple italic text-lg">${item.read}</td>
                                        <td class="px-10 py-6 text-xs text-gray-500 max-w-xs truncate">${item.review || '未填写复盘'}</td>
                                        <td class="px-10 py-6"><button class="text-gray-300 hover:text-slateDeep"><i data-lucide="more-horizontal"></i></button></td>
                                    </tr>
                                `).join('') || '<tr><td colspan="5" class="py-20 text-center text-gray-400 italic font-bold">暂无数据记录，请录入您的第一篇笔记</td></tr>'}
                            </tbody>
                        </table>
                    </div>
                `;
            },

            openModal() { document.getElementById('modal').classList.remove('hidden'); },
            closeModal() { document.getElementById('modal').classList.add('hidden'); },
        };

        document.getElementById('noteForm').onsubmit = (e) => {
            e.preventDefault();
            const newItem = {
                title: document.getElementById('m_title').value,
                type: document.getElementById('m_type').value,
                read: document.getElementById('v_read').value,
                review: document.getElementById('m_review').value,
                img: app.state.currentImg,
                time: new Date().toLocaleString()
            };
            app.state.db.unshift(newItem);
            localStorage.setItem('spark_pro_db', JSON.stringify(app.state.db));
            app.navigate('data');
            app.closeModal();
            // 重置
            app.state.currentImg = null;
            document.getElementById('imagePreview').classList.add('hidden');
        };

        window.onload = () => app.init();
    </script>
</body>
</html>
